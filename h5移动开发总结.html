<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<style>
h1,
h2,
h3,
h4,
h5,
h6,
p,
blockquote {
    margin: 0;
    padding: 0;
}
body {
    font-family: "Helvetica Neue", Helvetica, "Hiragino Sans GB", Arial, sans-serif;
    font-size: 13px;
    line-height: 18px;
    color: #737373;
    background-color: white;
    margin: 10px 13px 10px 13px;
}
table {
	margin: 10px 0 15px 0;
	border-collapse: collapse;
}
td,th {	
	border: 1px solid #ddd;
	padding: 3px 10px;
}
th {
	padding: 5px 10px;	
}

a {
    color: #0069d6;
}
a:hover {
    color: #0050a3;
    text-decoration: none;
}
a img {
    border: none;
}
p {
    margin-bottom: 9px;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    color: #404040;
    line-height: 36px;
}
h1 {
    margin-bottom: 18px;
    font-size: 30px;
}
h2 {
    font-size: 24px;
}
h3 {
    font-size: 18px;
}
h4 {
    font-size: 16px;
}
h5 {
    font-size: 14px;
}
h6 {
    font-size: 13px;
}
hr {
    margin: 0 0 19px;
    border: 0;
    border-bottom: 1px solid #ccc;
}
blockquote {
    padding: 13px 13px 21px 15px;
    margin-bottom: 18px;
    font-family:georgia,serif;
    font-style: italic;
}
blockquote:before {
    content:"\201C";
    font-size:40px;
    margin-left:-10px;
    font-family:georgia,serif;
    color:#eee;
}
blockquote p {
    font-size: 14px;
    font-weight: 300;
    line-height: 18px;
    margin-bottom: 0;
    font-style: italic;
}
code, pre {
    font-family: Monaco, Andale Mono, Courier New, monospace;
}
code {
    background-color: #fee9cc;
    color: rgba(0, 0, 0, 0.75);
    padding: 1px 3px;
    font-size: 12px;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    border-radius: 3px;
}
pre {
    display: block;
    padding: 14px;
    margin: 0 0 18px;
    line-height: 16px;
    font-size: 11px;
    border: 1px solid #d9d9d9;
    white-space: pre-wrap;
    word-wrap: break-word;
}
pre code {
    background-color: #fff;
    color:#737373;
    font-size: 11px;
    padding: 0;
}
sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:10px auto;
    }
}
@media print {
	body,code,pre code,h1,h2,h3,h4,h5,h6 {
		color: black;
	}
	table, pre {
		page-break-inside: avoid;
	}
}
</style>
<title>H5ç§»åŠ¨å¼€å‘æ€»ç»“(ä¸€)</title>

</head>
<body>
<h1>H5ç§»åŠ¨å¼€å‘æ€»ç»“(ä¸€)</h1>

<h2>ç®€ä»‹</h2>

<p>æœ¬æ–‡ä¸»è¦ä»é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„å·¥å…·ï¼Œæ¡†æ¶ç­‰é‡åˆ°çš„é—®é¢˜åšä¸ªæ€»ç»“ï¼Œè‡³äºå·¥å…·å’Œæ¡†æ¶çš„é€‰å‹ä¼˜åŠ£å°±ä¸è¿‡å¤šçš„åšä»‹ç»äº†ã€‚</p>

<h2>å·¥å…·ç¯‡</h2>

<h5>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨</h5>

<ul>
<li><p>ä»£ç ç¼–è¾‘å™¨</p>

<p>  Sublime,ä¸åšä»‹ç»,FEéƒ½æ‡‚ã€‚</p></li>
<li><p>httpåè®®è°ƒè¯•ä»£ç†å·¥å…·</p>

<p>  Fiddle,Charles(ä¸ªäººæ¯”è¾ƒå–œæ¬¢ï¼ŒMacä¸‹æ¨èä½¿ç”¨è¿™ä¸ª)</p></li>
<li><p>è¿œç¨‹è°ƒè¯•å·¥å…·</p>

<p>  weinre,ç§»åŠ¨å¼€å‘è°ƒè¯•"å¿…å¤‡",å³æ—¶æ›´æ”¹æ ·å¼ç­‰ï¼Œ
  è§£æ”¾ä½ çš„å³æ‰‹(ä¸åœ¨"alert"å®šä½é”™è¯¯)</p></li>
<li><p>çœæ—¶çš„æµè§ˆå™¨åŒæ­¥æµ‹è¯•å·¥å…·</p>

<p>  <a href="http://www.browsersync.io/">Browsersync</a> <a href="http://www.browsersync.cn/">ä¸­æ–‡</a>, å†…ç½®äº†weinre, Browsersyncèƒ½è®©æµè§ˆå™¨å®æ—¶ã€å¿«é€Ÿå“åº”æ‚¨çš„æ–‡ä»¶æ›´æ”¹ï¼ˆhtmlã€jsã€cssã€sassã€lessç­‰ï¼‰å¹¶è‡ªåŠ¨åˆ·æ–°é¡µé¢ã€‚æ›´é‡è¦çš„æ˜¯ Browsersyncå¯ä»¥åŒæ—¶åœ¨PCã€å¹³æ¿ã€æ‰‹æœºç­‰è®¾å¤‡ä¸‹è¿›é¡¹è°ƒè¯•ã€‚</p></li>
</ul>


<h2>æ¡†æ¶ç¯‡</h2>

<h5>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š</h5>

<blockquote><p>æ¡†æ¶æ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œå¯ä»¥å¤§å¹…æå‡å¼€å‘æ•ˆç‡ï¼Œä»£ç ç®€æ´åº¦ç­‰ï¼Œæ¡†æ¶æœ¬èº«ä¹Ÿå¹¶ä¸æ˜¯å®Œç¾çš„ï¼Œåœ¨å¼€å‘ä¸­åŒæ ·ä¹Ÿä¼šå¼•å…¥ä¸€äº›é—®é¢˜ï¼Œåé¢ä¼šåˆ†æç¢°åˆ°çš„é—®é¢˜ã€‚</p></blockquote>

<p>ä»¥ä¸‹ä»…ä»…ä»‹ç»é¡¹ç›®ä¸­ä½¿ç”¨çš„æ¡†æ¶ï¼š</p>

<ul>
<li><p><a href="http://www.zeptojs.cn/">Zepto.js</a></p>

<p>  è¢«ç§°ä¸ºç®€åŒ–ç‰ˆçš„jQuery</p></li>
<li><p><a href="http://www.requirejs.cn/">require.js</a></p>

<p>  æ¨¡å—åŒ–, å½“ç„¶ä½ å¯ä»¥é€‰æ‹©å…¶å®ƒçš„ï¼Œseajs,webPack,commonJsç­‰ï¼Œå…¶ä¸­ä¼˜åŠ£å°±ä¸å†è¿™é‡Œè¯´äº†ï¼Œé€‰æ‹©é€‚åˆè‡ªå·±çš„ï¼Œæ²¡æœ‰æœ€å¥½çš„ï¼Œåªæœ‰é€‚åˆè‡ªå·±çš„ã€‚</p></li>
<li><p><a href="http://iscrolljs.com/">iScroll.js</a></p>

<p>  çœ‹åå­—å°±çŸ¥é“äº†ï¼Œå°±æ˜¯å„ç§æ»šåŠ¨ï¼Œç¿»é¡µç­‰</p></li>
<li><p><a href="http://backbonejs.org/">Backbone.js</a></p>

<p>  Backbone.jsä¸ºå¤æ‚WEBåº”ç”¨ç¨‹åºæä¾›æ¨¡å‹(models)ã€é›†åˆ(collections)ã€è§†å›¾(views)çš„ç»“æ„ã€‚</p></li>
<li><p><a href="http://underscorejs.org/">Underscore.js</a></p>

<p>  Underscoreä¸€ä¸ªJavaScriptå®ç”¨åº“ï¼Œæä¾›äº†ä¸€æ•´å¥—å‡½æ•°å¼ç¼–ç¨‹çš„å®ç”¨åŠŸèƒ½</p></li>
<li><p><a href="https://github.com/ftlabs/fastclick">fastclick.js</a></p>

<p>  è§£å†³300mså»¶è¿Ÿé—®é¢˜ã€‚</p></li>
</ul>


<h2>é—®é¢˜ç¯‡</h2>

<h3>zepto.js</h3>

<h4>DomèŠ‚ç‚¹ä»éšè—åˆ°æ˜¾ç¤ºæ–¹æ³•ï¼Œç›´æ¥çœ‹æºç ï¼Œå¦‚ä¸‹ï¼š</h4>

<pre><code>show: function(){
      return this.each(function(){
        this.style.display == "none" &amp;&amp; (this.style.display = '')
        if (getComputedStyle(this, '').getPropertyValue("display") == "none")
          this.style.display = defaultDisplay(this.nodeName)
      })
    }
 $.fn.show = function(speed, callback) {
    origShow.call(this) //ä¸Šé¢çš„showæ–¹æ³•
    if (speed === undefined) speed = 0
    else this.css('opacity', 0)
    return anim(this, speed, 1, '1,1', callback)
 }
function defaultDisplay(nodeName) {
    var element, display
    if (!elementDisplay[nodeName]) {
      element = document.createElement(nodeName)
      document.body.appendChild(element)
      display = getComputedStyle(element, '').getPropertyValue("display")
      element.parentNode.removeChild(element)
      display == "none" &amp;&amp; (display = "block")
      elementDisplay[nodeName] = display
    }
    return elementDisplay[nodeName]
  }
</code></pre>

<p>å‘ç°é—®é¢˜äº†å—ï¼Ÿ ä¸¾ä¾‹ï¼š</p>

<ol>
<li><p>å¦‚æœä¸€ä¸ªåŠé€æ˜çš„å…ƒç´ hideä¹‹åï¼Œå†æ¬¡è°ƒç”¨showï¼Œè¿™æ—¶showå‡ºæ¥çš„å…ƒç´ å°†ä¸å†æ˜¯åŠé€æ˜;</p></li>
<li><p>è¿™è¿˜ç®—æ˜¯å°äº‹ï¼Œå¦‚æœä¸€ä¸ªå…ƒç´ ï¼Œä½ æ”¹å˜äº†ä»–çš„é»˜è®¤displayå±æ€§ï¼Œå¦‚åŸæ¥æ˜¯blockçš„è‡ªå®šä¹‰æˆäº†flexï¼Œé‚£ä¹ˆshowå‡ºæ¥çš„å°†ä¼šæ˜¯blockï¼Œè¿™æ—¶å¾ˆæœ‰å¯èƒ½æ•´ä¸ªé¡µé¢æ ·å¼å°±ä¹±äº†ï¼›</p></li>
</ol>


<p>jQueryè¿™ä¸€å—åšçš„å°±æ¯”è¾ƒå¥½ï¼Œä»–ä¼šå…ˆä¿å­˜è‡ªå®šä¹‰çš„displayå±æ€§ï¼Œshowçš„æ—¶å€™ä¸ä¼šæ”¹å˜è‡ªå®šä¹‰çš„displayå±æ€§ã€‚ä»£ç å°±ä¸è´´äº†ï¼Œæœ‰å…´è¶£çš„è‡ªè¡Œçœ‹æºç å§ã€‚</p>

<p>é’ˆå¯¹ä¸Šè¿°é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p>

<p>è‡ªå®šä¹‰ç±»</p>

<pre><code>.hide {
    display: none!important;
}
</code></pre>

<p>å½“éœ€è¦éšè—çš„æ—¶å€™addClass('hide'), æ˜¾ç¤ºçš„æ—¶å€™removeClass('hide')ã€‚</p>

<h4>touchäº‹ä»¶</h4>

<p>æŸ¥çœ‹Zeptoçš„<a href="https://github.com/madrobby/zepto/blob/master/src/touch.js#files">touchäº‹ä»¶æºç </a></p>

<pre><code>$(document).on('touchstart', fn)
            .on('touchmove', fn)
            .on('touchend', fn)
</code></pre>

<p>å¯ä»¥çœ‹å‡ºZeptoå°†äº‹ä»¶ä»£ç†åœ¨äº†documentä¸Š, é‚£ä¹ˆé—®é¢˜æ¥äº†, å¦‚æœæœ‰èŠ‚ç‚¹äº‹ä»¶é˜»æ­¢äº†å†’æ³¡æ€ä¹ˆåŠ,å½“ç„¶äº†è¿™ç§åº”ç”¨åœºæ™¯æ¯”è¾ƒç‰¹æ®Š,</p>

<p>ä¸¾ä¸ªåœºæ™¯ä¾‹å­:</p>

<p><img src="./assets/page.jpeg" alt="image" /></p>

<p>æˆ‘ä»¬ä½¿ç”¨iScrollåˆå§‹åŒ–äº†ä¸¤ä¸ªæ»šåŠ¨å®ä¾‹åˆ†åˆ«æ˜¯Aå’ŒBï¼ŒBå®ä¾‹çš„DOMèŠ‚ç‚¹æ˜¯Bçš„å­—èŠ‚ç‚¹ï¼Œè¦æ±‚æ˜¯æ»šåŠ¨Bçš„æ—¶å€™Aä¸åŠ¨ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦åœ¨åˆå§‹åŒ–Bçš„æ—¶å€™touchmoveäº‹ä»¶é˜»æ­¢å†’æ³¡ï¼Œè¿™æ ·åœ¨BåŒºåŸŸæ»šåŠ¨çš„æ—¶å€™ï¼ŒAåŒºåŸŸå°±ä¸ä¼šå˜åŒ–ï¼Œåˆ°è¿™é‡Œå¹¶æ²¡æœ‰çœ‹å‡ºä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æ­¤æ—¶å¦‚æœBåŒºåŸŸä¸­æœ‰tapå‘¢ï¼Œç”±äºZeptoæ•è·ä¸åˆ°touchmoveäº‹ä»¶ï¼Œç­‰åˆ°touchendçš„æ—¶å€™ï¼Œå°±ä¸èƒ½å‡†ç¡®çš„åˆ¤æ–­å‡ºæ˜¯tapè¿˜æ˜¯swipeäº‹ä»¶äº†ï¼Œæœ€ç»ˆç»“æœå¯æƒ³è€ŒçŸ¥ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç»å¯¹å®šä½æŠŠBä¸ä½œä¸ºAçš„å­—èŠ‚ç‚¹ï¼Œè¿™æ ·å°±ä¸å­˜åœ¨è¯¥é—®é¢˜äº†ï¼Œhtmlæ ‡ç­¾ç»“æ„ä¹±ä¹Ÿå°±ç®—äº†ï¼Œè‹¦é€¼çš„æ˜¯è¿™æ ·åˆå¸¦æ¥äº†æ–°çš„é—®é¢˜ï¼šæ»šåŠ¨Açš„æ—¶å€™ï¼ŒBçš„æ»šåŠ¨æ€ä¹ˆå¤„ç†ï¼Ÿ</p>

<p>æµè§ˆå™¨æœ¬èº«ä¸æ”¯æŒtapäº‹ä»¶ï¼Œtapäº‹ä»¶æ˜¯Zeptoåœ¨touchendçš„æ—¶å€™è§¦å‘çš„ï¼Œè¿™æ ·å°±ä¸å­˜åœ¨clickäº‹ä»¶çš„300msçš„å»¶è¿Ÿé—®é¢˜äº†ï¼Œä½ ä»¥ä¸ºè¿™æ ·å°±ä¸‡äº‹å¤§å‰äº†ï¼Œæˆ‘åªèƒ½è¯´too young too simpleï¼›ç®€å•çš„è¯´ä¸‹300msçš„å»¶è¿Ÿé—®é¢˜ï¼Œè¯¦ç»†çš„è¯·è‡ªè¡Œgoogle, æ‰€è°“çš„300mså°±æ˜¯è§¦å±äº‹ä»¶åˆ¤æ–­æ˜¯å•å‡»è¿˜æ˜¯åŒå‡»è€Œå¼•å…¥çš„æœºåˆ¶ï¼Œç”±æ­¤å¼•èµ·çš„é—®é¢˜å°±æ˜¯ï¼šç”¨æˆ·ä½“éªŒä¸å¥½ï¼Œè¿˜æœ‰å…¸å‹çš„â€œç‚¹é€ç°è±¡â€ã€‚ tapäº‹ä»¶çš„ç¡®è§£å†³äº†clickäº‹ä»¶çš„å»¶è¿Ÿé—®é¢˜ï¼Œä½†æ˜¯åƒ"aæ ‡ç­¾, input, select,textarea"ç­‰çš„åŸç”Ÿäº‹ä»¶çš„å»¶è¿Ÿç¡®æ²¡æœ‰æœ‰æ•ˆçš„è§£å†³ï¼Œaæ ‡ç­¾æˆ‘ä»¬å¯ä»¥è‡ªå·±å¯¹å…¶å†™tapäº‹ä»¶ï¼Œä½†æ˜¯åƒinputè¿™ç§å¤æ‚çš„æ ‡ç­¾å°±æ²¡æœ‰é‚£ä¹ˆå®¹æ˜“äº†ã€‚</p>

<p>åŸæœ¬æˆ‘ä»¬æ˜¯å¯ä»¥åƒaæ ‡ç­¾é‚£æ ·å¯¹å…¶å†™tapäº‹ä»¶ï¼Œå¦‚ä¸‹</p>

<pre><code>$('input').on('tap',function(){
    $(this).focus();
})
</code></pre>

<p>ä¸Šé¢çš„ä»£ç çœ‹ç€æ˜¯æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œç‚¹å‡»inputæ ‡ç­¾çš„æ—¶å€™çš„ï¼Œé”®ç›˜æ­£å¸¸å¼¹èµ·ï¼Œå¿ƒä¸­ä¸€é˜µçªƒå–œï¼Œæ®Šä¸çŸ¥å†™äº†ä¸€æ®µåªèƒ½å‡‘KPIçš„ä»£ç ã€‚çœ‹å¦‚ä¸‹zeptoæºä»£ç ï¼š</p>

<pre><code>tapTimeout = setTimeout(function() {
    var event = $.Event('tap')
    event.cancelTouch = cancelAll
    touch.el.trigger(event)
    ...
}, 0)
</code></pre>

<pre><code>å®˜æ–¹å®šä¹‰ï¼šsetTimeout() æ–¹æ³•ç”¨äºåœ¨æŒ‡å®šçš„æ¯«ç§’æ•°åè°ƒç”¨å‡½æ•°æˆ–è®¡ç®—è¡¨è¾¾å¼ã€‚
</code></pre>

<p>tapäº‹ä»¶è¢«æ”¾åœ¨äº†setTimeoutä¸­æ‰§è¡Œï¼Œ0mså¹¶ä¸æ˜¯æ„å‘³ç€å‡½æ•°ç«‹åˆ»æ‰§è¡Œï¼Œ</p>

<p>ç¬¬ä¸€ï¼šå„ä¸ªæµè§ˆå™¨å¯¹setTimeoutæœ‰ä¸€ä¸ªæœ€å°çš„æ—¶é—´å€¼(å¤§æ¦‚10mså·¦å³ï¼Œä¸è¦çº ç»“è¿™ä¸ªæ•°å­—ï¼Œä¸åŒæµè§ˆå™¨ä¸ä¸€æ ·)ï¼Œå½“è®¾ç½®çš„å»¶è¿Ÿæ•°å°äºæœ€å°å€¼æ—¶ï¼Œå°†å–æœ€å°å€¼ï¼›</p>

<p>ç¬¬äºŒï¼šsetTimeout(fn,delay)å°†fnæŠ›å‡ºå½“å‰æ‰§è¡Œé˜Ÿåˆ—ï¼Œdelayæ¯«ç§’åå†æ’å…¥å½“å‰é˜Ÿåˆ—ä¸­æ‰§è¡Œï¼›
ä¹Ÿå°±è¯´å³ä¾¿æ˜¯0msï¼Œä¹Ÿè¦æ’å…¥åˆ°é˜Ÿåˆ—æœ«å°¾å»æ‰§è¡Œäº†ã€‚</p>

<p><a href="./demo/001.html">çœ‹demo</a> ç‚¹å‡»tapBtnè¿™ä¸ªæ—¶å€™focusäº‹ä»¶æ‰§è¡Œï¼Œä½†æ˜¯é”®ç›˜æ²¡æœ‰å¼¹å‡ºï¼Œå½“ç»§ç»­ç‚¹å‡»tapBtnçš„æ—¶å€™ï¼Œè¿™æ—¶å€™é”®ç›˜ç›´æ¥å¼¹å‡ºï¼Œæ³¨å†Œçš„focusäº‹ä»¶åè€Œæ²¡æœ‰å†æ¬¡æ‰§è¡Œï¼Œå¥½è¯¡å¼‚çš„äº‹æƒ…ï¼Œæš‚æ—¶è¿˜æ²¡ææ˜ç™½ï¼Œå¦‚å“ªä½å¤§ç¥çŸ¥é“å…¶ä¸­åŸç†ï¼Œæ¬¢è¿è§£ç­”ï¼Œéå¸¸æ„Ÿè°¢ï¼</p>

<p>æ€»ä¹‹ï¼Œtapäº‹ä»¶æ˜¯è§£å†³ä¸äº†inputçš„å»¶è¿Ÿé—®é¢˜äº†ï¼Œé’ˆå¯¹æ­¤é—®é¢˜æˆ‘ä»¬å¦‚ä½•è§£å†³å‘¢ï¼Œå¤§å¤šæ•°ç½‘ç«™å¯¹äºinputï¼Œtextareaæ ‡ç­¾çš„300mså»¶è¿Ÿæ˜¯æ²¡æœ‰å¤„ç†çš„ï¼Œä»ä½“éªŒä¸Šæ¥è¯´ï¼Œå¯¹äº300msçš„å»¶è¿Ÿåå¼¹å‡ºé”®ç›˜ï¼Œå¤§å¤šä¹Ÿéƒ½å¯ä»¥æ¥å—ï¼Œä¸è¿‡å‰é¢æˆ‘ä»¬è¿˜æåˆ°è¿‡ä¸€ç§â€œç‚¹é€â€ç°è±¡ï¼Œå¾ˆä¸å¹¸çš„æ˜¯å¦‚æœå…¶ä»–äº‹ä»¶å¤„ç†äº†300mså»¶è¿Ÿï¼Œè€Œåˆšå¥½inputæ¡†åœ¨ç‚¹å‡»èŠ‚ç‚¹çš„ä¸‹é¢ï¼Œé‚£ä¹ˆç‚¹é€ç°è±¡å°±å‘ç”Ÿäº†<a href="./demo/002.html">demo</a>ã€‚</p>

<p>å¦‚æœä¸è€ƒè™‘åœ¨inputæ¡†ä¸Šçš„æ»‘åŠ¨ï¼Œå¯ä»¥åœ¨touchendçš„æ—¶å€™ç›´æ¥focusï¼Œäº‹å®ä¸Šæœ‰äº›äº§å“æ˜¯è¿™ä¹ˆåšçš„ã€‚å³ä¾¿è€ƒè™‘æ»‘åŠ¨ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å†™äº‹ä»¶åˆ¤æ–­ã€‚å¦‚æœä½ çŸ¥é“300msçš„å»¶è¿Ÿï¼Œé‚£ä¹ˆä½ ä¸€å®šçŸ¥é“fastClick.jsï¼Œå®ƒå°±æ˜¯ä¸ºäº†è§£å†³300msçš„å»¶è¿Ÿè¯ç”Ÿçš„ã€‚</p>

<h3>fastClick.js</h3>

<p>fastClickä¸ä»…è§£å†³äº†clickäº‹ä»¶çš„å»¶è¿Ÿï¼ŒåŒæ ·ä¹Ÿè§£å†³äº†a, inputï¼Œtextareaç­‰æ ‡ç­¾çš„é»˜è®¤äº‹ä»¶å»¶è¿Ÿé—®é¢˜ï¼Œä¸‹é¢æˆ‘ä»¬æ¥åˆ†æä¸‹ï¼ŒfastClickæ˜¯å¦‚ä½•åšåˆ°çš„ã€‚</p>

<p>åœ¨è¿™é‡Œè¿˜è¦æåˆ°ä¸€ä¸ªzeptoçš„tapäº‹ä»¶çš„å¦ä¸€ä¸ªç¼ºç‚¹ï¼šPCæµè§ˆå™¨(chrome)æ‰“å¼€åï¼Œå¦‚æœä¸åˆ‡æ¢åˆ°ç§»åŠ¨æ¨¡æ‹ŸçŠ¶æ€ï¼Œtapäº‹ä»¶æ˜¯ä¸ä¼šå“åº”çš„ï¼Œå¯¹è°ƒè¯•ä¹Ÿå¸¦æ¥äº†ä¸ä¾¿(å…¶å®ä¹Ÿæ²¡ä»€ä¹ˆå¤§é—®é¢˜)ã€‚
å¦‚æœæˆ‘ä»¬ä½¿ç”¨fastClickï¼Œå°±å¯ä»¥åƒPCå¼€å‘é‚£æ ·ï¼Œç›´æ¥ä½¿ç”¨clickï¼Œå…¶å®ƒçš„äº‹å°±äº¤ç»™fcå»åšå°±å¥½äº†ï¼Œå¦‚ä¸‹æºä»£ç å¯ä»¥çœ‹å‡ºï¼ŒfastClickå¯¹æ­¤ç§æƒ…å†µçš„å¤„ç†æ–¹å¼ã€‚</p>

<pre><code>// Devices that don't support touch don't need FastClick
if (typeof window.ontouchstart === 'undefined') {
    return true;
}
</code></pre>

<p>å†æ¥è¯´æ­£äº‹ï¼ŒfastClickæ˜¯åŒæ ·ä¹Ÿæ˜¯åœ¨touchendçš„æ—¶å€™å»åˆ¤æ–­è¯¥è§¦å‘çš„äº‹ä»¶ï¼Œå¹¶ä¸”é˜»æ­¢èŠ‚ç‚¹çš„é»˜è®¤äº‹ä»¶:</p>

<pre><code>FastClick.prototype.sendClick = function(targetElement, event) {
    var clickEvent, touch;

   // On some Android devices activeElement needs to be blurred otherwise the synthetic click will have no effect (#24)
    if (document.activeElement &amp;&amp; document.activeElement !== targetElement) {
        document.activeElement.blur();
    }
    touch = event.changedTouches[0];
    clickEvent = document.createEvent('MouseEvents');
    clickEvent.initMouseEvent(this.determineEventType(targetElement), true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);
    clickEvent.forwardedTouchEvent = true;
    targetElement.dispatchEvent(clickEvent);
};
</code></pre>

<p>fastClickè¿˜æœ‰ä¸€ä¸ªä¼˜ç‚¹å°±æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±å®šä¹‰ä»£ç†èŠ‚ç‚¹ï¼Œä¸åƒzeptoé‚£æ ·ï¼Œåªèƒ½ä»£ç†åœ¨documentä¸Šï¼Œè€Œä¸”fastClickè¿˜å¯ä»¥é€šè¿‡ä¼ å‚çš„æ–¹å¼è‡ªå®šä¹‰options,æ›´åŠ çµæ´»çš„æ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡éœ€æ±‚ï¼š</p>

<pre><code>/**
 * Touchmove boundary, beyond which a click will be cancelled.
 */

this.touchBoundary = options.touchBoundary || 10;
/**
 * The minimum time between tap(touchstart and touchend) events
 */
this.tapDelay = options.tapDelay || 200;

/**
 * The maximum time for a tap
 */
this.tapTimeout = options.tapTimeout || 700;
</code></pre>

<h3>iScroll.js</h3>

<p>å…ˆè¯´ä¸€ä¸‹ä½¿ç”¨åœºæ™¯ï¼Œé¡¹ç›®æ˜¯ä½¿ç”¨cordovaå°è£…æˆiosåº”ç”¨(iPad),å•é¡µé¢ï¼Œå¯¹äºé¡µé¢çš„åˆ‡æ¢æœ‰ä¸¤ç§æ–¹å¼ï¼ˆç‚¹å‡»åˆ‡æ¢ï¼Œæ•´å±æ¨ªå‘æ»‘åŠ¨åˆ‡æ¢ï¼‰,é¡µé¢ä¸­è¿˜æœ‰éœ€è¦æ¨ªå‘å’Œç«–å‘çš„æ»šåŠ¨ï¼Œå…±ç”¨åˆ°äº†å¦‚ä¸‹ä¸¤ç§æ»šåŠ¨ï¼š</p>

<ol>
<li>æ™®é€šçš„æ»šåŠ¨ï¼Œæ²¡ä»€ä¹ˆå¯è¯´çš„ï¼Œç…§ç€apiæ¥å°±è¡Œ</li>
<li>ç±»è½®æ’­å›¾çš„æ»šåŠ¨ï¼Œå³snap: trueï¼›</li>
</ol>


<p>åœ¨å¼€å‘ç¬¬äºŒç§æ»šåŠ¨æ—¶ï¼Œé‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œ</p>

<ol>
<li><p>æ‰‹æŒ‡æ²¿ç€iPadä¸€ä¾§è¾¹ç¼˜æ»‘å‡ºæ—¶ï¼ˆåªæœ‰ä¸€ä¾§ï¼Œå¾ˆè¯¡å¼‚ï¼‰ï¼Œæ²¡æœ‰è§¦å‘touchendäº‹ä»¶ï¼Œè¿™æ—¶æ»‘åŠ¨äº†ä¸€åŠçš„é¡µé¢å°±åœåœ¨é‚£é‡Œä¸åŠ¨äº†ï¼Œåˆšå¼€å§‹ä»¥ä¸ºæ˜¯ipadç¡¬ä»¶é—®é¢˜ï¼Œåæ¥è¯•äº†å¤šæ¬¾æœºå­ï¼Œä¼šæœ‰åŒæ ·çš„é—®é¢˜
ï¼ˆipad air2ï¼Œç»™å…¬å¸å†…éƒ¨é”€å”®å‘˜å·¥ä½¿ç”¨çš„APPï¼Œä»…è¦æ±‚é€‚é…æ­¤æœºå‹ï¼‰</p>

<p>  è§£å†³æ–¹æ³•ï¼š</p>

<p>  å°½ç„¶ç›‘å¬ä¸åˆ°touchendï¼Œé‚£å°±åœ¨touchmoveçš„æ—¶å€™åšåˆ¤æ–­äº†ï¼Œå½“æ‰‹æŒ‡æ»‘åŠ¨åˆ°è¾¹ç¼˜æ—¶ç›´æ¥æ‰§è¡ŒiScrollçš„goToPageæ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹</p>

<pre><code>  //æ³¨æ„ï¼šæ‰‹æŒ‡åœ¨padä¸Šæ»‘åŠ¨æ—¶touchmoveç›‘å¬åˆ°çš„æœ€å¤§pointXï¼Œä¸€ä¾§æ˜¯1022ï¼Œä¸€ä¾§æ˜¯1023ï¼Œæˆ‘é…ç½®çš„this.options.iosWebViewWidth = 1020
  if(this.iosWebViewBug &amp;&amp; this.options.iosWebViewWidth &amp;&amp; this.pointX &gt;= this.options.iosWebViewWidth){
      this.options.ioswebviewwidth = false;
      var time = this.options.snapSpeed || Math.max(
              Math.max(
                  Math.min(Math.abs(this.x - this.startX), 1000),
                  Math.min(Math.abs(this.y - this.startY), 1000)
              ), 300);

      var fromX = -this.currentPage.pageX * this.wrapperWidth;
      var toX = Math.round(this.x);
      if(Math.abs(fromX - toX) &lt; 400){
          this.directionX = 0;
      }

      this.goToPage(
          this.currentPage.pageX + this.directionX,
          this.currentPage.pageY + this.directionY,
          time
      );
      return;
  }
</code></pre></li>
<li><p>è¿ç»­ç‚¹å‡»ä¼šå¾ˆå®¹æ˜“è§¦å‘flickäº‹ä»¶ï¼Œä¼šå¯¼è‡´é¡µé¢åˆ‡æ¢ï¼Œåœ¨flickæ‰§è¡Œæ—¶åˆ¤æ–­ä¸‹æ»‘åŠ¨è·ç¦»ï¼Œå¦‚æœæ»‘åŠ¨è·ç¦»å°äºæˆ‘ä»¬è®¾ç½®çš„é˜ˆå€¼ï¼Œå°±ä¸è¦è§¦å‘é¡µé¢åˆ‡æ¢ï¼Œå¦‚ä¸‹ä»£ç ä¸­customThresholdæ˜¯è‡ªå®šä¹‰çš„é˜ˆå€¼ï¼š</p>

<pre><code> this.on('flick', function () {
     var time = this.options.snapSpeed || Math.max(
             Math.max(
                 Math.min(Math.abs(this.x - this.startX), 1000),
                 Math.min(Math.abs(this.y - this.startY), 1000)
             ), 300);

     if(this.options.customThreshold){
         var fromX = -this.currentPage.pageX * this.wrapperWidth;
         var toX = Math.round(this.x);
         var temp = fromX - toX;
         if(Math.abs(temp) &lt; this.options.customThreshold || this.directionX * temp &lt; 0){
             this.directionX = 0;
         }
     }
     this.goToPage(
         this.currentPage.pageX + this.directionX,
         this.currentPage.pageY + this.directionY,
         time
     );
 });
</code></pre>

<p> å½“ç„¶ä½ å¯ä»¥é€‰æ‹©å…¶å®ƒçš„ç±»ä¼¼æ¡†æ¶ï¼Œå…¶å®ƒæ¡†æ¶æ˜¯å¦æœ‰ç±»ä¼¼é—®é¢˜ï¼Œæˆ‘ä¸ç¡®å®šï¼Œå‰æœŸè°ƒç ”åšçš„ä¸å¤Ÿå……åˆ†ï¼Œè¿™ç§bugå‰æœŸä¹Ÿå¾ˆéš¾å‘ç°ï¼Œç­‰åˆ°å‘ç°çš„æ—¶å€™é¡¹ç›®å·²åœ¨æµ‹è¯•é˜¶æ®µï¼Œè™½ç„¶è¿™ä¸€å—æ¢ç”¨å…¶å®ƒæ¡†æ¶ä¹Ÿä¸æ˜¯ç‰¹åˆ«éº»çƒ¦ï¼Œä½†æ˜¯å…¶å®ƒæ¡†æ¶æœªå¿…ä¸ä¼šæœ‰å…¶å®ƒé—®é¢˜å¼•å…¥ï¼Œå†è¯´äº†è‡ªå·±çº¦çš„ç‚®ï¼Œå«ç€æ³ªä¹Ÿè¦æ‰“å®ŒğŸ˜¢ã€‚</p></li>
<li><p>å½“å•ä¸ªæ‰‹æŒ‡æ»‘åŠ¨æ—¶ï¼Œå°†å…¶å®ƒæ‰‹æŒ‡æ”¾ä¸Šæ»‘åŠ¨åŒºåŸŸï¼Œå†æ¬¡è§¦å‘touchstartäº‹ä»¶ï¼Œä¸è¦æ»‘åŠ¨ï¼ˆä¸è¦è§¦å‘touchmoveäº‹ä»¶ï¼‰ï¼Œç›´æ¥ç§»å¼€æ‰‹æŒ‡ï¼Œæ­¤æ—¶é¡µé¢å°±å®šåœ¨ç¦»å¼€æ—¶çš„ä½ç½®ã€‚çœ‹ç®€åŒ–æºç ï¼š</p>

<pre><code> _start: function (e) {
     ...
     this.moved = false;
     ...
 }
 _move: function (e) {
     ...
     this.moved = true;
     ...
 }
 _end: function (e) {
     ...
     if ( !this.moved ) {
         ...
         return;
     }
     ...
 }
</code></pre>

<p>iscrollæ¯æ¬¡è§¦å‘touchstartæ—¶éƒ½ä¼šå°†movedç½®ä¸ºfalse, å½“åœ¨æ»‘åŠ¨æ—¶æ”¾ä¸Šé¢å¤–çš„æ‰‹æŒ‡è§¦å‘touchstartäº‹ä»¶ï¼Œå¦‚æœè¿‡æ²¡æœ‰touchmoveï¼Œç›´æ¥è§¦å‘touchendï¼Œé‚£ä¹ˆé¡µé¢å°±è¢«å®šåœ¨äº†ç¦»å¼€æ—¶çš„ä½ç½®ï¼Œé’ˆå¯¹æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨touchstartæ—¶å¢åŠ å¦‚ä¸‹åˆ¤æ–­å³å¯ï¼š</p>

<pre><code>  _start: function (e) {
      var tempMoved = this.moved;
      ...
      this.moved = false;
      //æ”¹å˜æºä»£ç æ—¶ï¼ŒåŠ ä¸€ä¸ªé…ç½®å‚æ•°ï¼Œé¿å…æ”¹å˜æºä»£ç è€Œå¼•å…¥å…¶å®ƒçš„é—®é¢˜ï¼ˆå¦‚æœä½ ç ”ç©¶çš„é€å½»å¯å¿½ç•¥ï¼‰
      if(this.options.customThreshold &amp;&amp; e.touches.length &gt; 1){
          this.moved = tempMoved;
      }
      ...
  }
</code></pre></li>
</ol>


<h2>æ€§èƒ½ç¯‡</h2>

<p>å¯¹äºå‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šè¿™æ–¹é¢çš„æ–‡ç« ï¼Œå¦‚csså¤´éƒ¨ï¼Œjsæ”¾å°¾éƒ¨ï¼Œé™æ€èµ„æºå‹ç¼©åˆå¹¶ï¼Œç²¾çµå›¾ï¼Œgzipï¼Œå›¾ç‰‡æ‡’åŠ è½½ç­‰ï¼Œè¿™äº›åŸºæœ¬éƒ½å·²ç»æˆæ ‡é…äº†ï¼Œè‡³äºä»£ç çš„ä¼˜åŒ–ç¨‹åº¦ï¼Œå‡å°‘é¡µé¢é‡ç»˜å’Œé‡æ’ï¼Œå‡å°‘è·å–èŠ‚ç‚¹æ¬¡æ•°ä»¥åŠCSSçš„è§„èŒƒç­‰ï¼Œè¿™äº›å°±çœ‹å¼€å‘äººå‘˜çš„ç´ è´¨äº†,ä»¥ä¸Šè¿™äº›æˆ‘ä»¬å°±ä¸ä»‹ç»äº†ã€‚å‰é¢æåˆ°è¿‡æˆ‘ä»¬çš„é¡¹ç›®æ˜¯cordovaå°è£…æˆAPPï¼Œé‚£ä¹ˆå¯¹äºé™æ€èµ„æºçš„å‹ç¼©æ··æ·†ç­‰å¹¶æ²¡æœ‰åƒwebé‚£ä¹ˆä¸¥æ ¼ï¼Œå¤§å¤šæ•°é™æ€èµ„æºéƒ½æ˜¯æœ¬åœ°æ–‡ä»¶ã€‚å¯¹äºAPPæˆ‘ä»¬æœ€æ‹…å¿ƒçš„å°±æ˜¯é—ªé€€çš„é—®é¢˜ï¼Œè€Œé—ªé€€å¾ˆå¤§ä¸€éƒ¨åˆ†åŸå› æ˜¯å†…å­˜æ³„æ¼å¼•èµ·ï¼Œæ™®é€šç½‘é¡µè®¿é—®è¿˜å¥½ï¼Œåˆ‡æ¢urlåï¼Œä¹‹å‰ç½‘é¡µæ‰€å çš„å†…å­˜ä¼šé‡Šæ”¾ï¼Œè¿™ä¹Ÿæ˜¯å¤§å¤šç½‘ç«™å¼€å‘æ—¶ï¼Œä¸å¤ªå…³æ³¨å†…å­˜çš„åŸå› ï¼Œä½†æ˜¯æˆ‘ä»¬çš„é¡¹ç›®æ˜¯å•é¡µWebåº”ç”¨ï¼ˆsingle page web applicationï¼ŒSPAï¼‰ï¼Œå¯¹äºå†…å­˜çš„é‡Šæ”¾å°±ä¸å¾—ä¸è€ƒè™‘äº†ã€‚é¡¹ç›®çš„æ•´ä½“ç»“æ„å¦‚ä¸‹å›¾ï¼š
<img src="./assets/crm_arch.jpeg" alt="image" /></p>

<p>å¯¼èˆªå’Œæ»šåŠ¨æ”¹å˜routerï¼Œæ¯ä¸€ä¸ªè·¯ç”±éƒ½ä¼šç»è¿‡viewç®¡ç†å™¨ï¼Œåœ¨viewç®¡ç†å™¨åˆ¤æ–­åº”è¯¥ç”Ÿæˆçš„å’Œæ‘§æ¯çš„viewã€‚</p>

<p>æ³¨æ„è¿™é‡Œå› ä¸ºæˆ‘ä»¬æœ‰æ»‘åŠ¨åˆ‡æ¢é¡µé¢(view)çš„éœ€æ±‚ï¼Œä¸ºäº†åœ¨æ»‘åŠ¨è¿‡ç¨‹ä¸­æˆ‘ä»¬èƒ½çœ‹åˆ°ä¸‹(ä¸Š)ä¸€é¡µçš„é¡µé¢ï¼Œæˆ‘ä»¬é¢„åŠ è½½äº†å‰åä¸¤ä¸ªviewï¼Œæ­£å¸¸æƒ…å†µä¸‹viewsç®¡ç†å™¨ä¸­åº”è¯¥åªæœ‰3ä¸ªviewå­˜åœ¨ï¼Œé¦–é¡µå’Œæœ«é¡µæœ‰ä¸¤ä¸ªviewï¼Œè¿™ä¸éš¾ç†è§£å§ï¼Œå¯¹äºåƒç™»å½•é¡µé¢è¿™ç§ä¸å¯ä»¥æ»šåŠ¨çš„viewï¼Œåªéœ€è¦ä¸€ä¸ªviewï¼Œå…¶å®ƒä¸éœ€è¦çš„viewéƒ½è¦destoryæ‰ã€‚å…·ä½“çš„é”€æ¯æœºåˆ¶ï¼Œæ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹ï¼Œè‡ªå·±å®šã€‚Backboneæœ‰view.removeæ–¹æ³•ï¼Œå¸®åŠ©æˆ‘ä»¬destoryæ‰å½“å‰viewï¼Œé‡Šæ”¾å½“å‰viewæ‰€å å†…å­˜ã€‚</p>

<pre><code>view.remove()
Removes a view and its el from the DOM, and calls stopListening to  remove any bound events that the view has listenTo'd.
remove: function() {
  this._removeElement();
  this.stopListening();
  return this;
}
</code></pre>

<p>ä½†æ˜¯removeé‡Šæ”¾çš„å¹¶ä¸å½»åº•, æˆ‘ä»¬viewä¸­è¿˜ç”¨åˆ°äº†å…¶å®ƒç¬¬ä¸‰æ–¹çš„åº“ï¼Œå¦‚eChartsï¼ŒiScrollå¯¹äºä»–ä»¬ç”Ÿæˆçš„å®ä¾‹åœ¨removeå‰ï¼Œè¦å…ˆè°ƒç”¨å®ä¾‹å¯¹åº”çš„destoryæ–¹æ³•(æ–¹æ³•åä¸ä¸€å®šæ˜¯è¿™ä¸ª)ã€‚å¯ä»¥ä½¿ç”¨Chromeçš„ <a href="http://www.kazaff.me/2014/01/26/chrome-developer-tools%E4%B9%8B%E5%86%85%E5%AD%98%E5%88%86%E6%9E%90/">Heap Profiling</a>æ’æŸ¥å†…å­˜æ˜¯å¦æ³„æ¼ã€‚</p>
</body>
</html>